# -- Provide a name in place of `shlink-backend`
nameOverride: ""
# -- String to fully override `"shlink-backend.fullname"`
fullnameOverride: ""

# @ignored
global:
  security:
    allowInsecureImages: true

image:
  # -- image registry
  registry: docker.io
  # -- image repository
  repository: shlinkio/shlink
  # -- image pull policy
  pullPolicy: Always
  # -- Overrides the image tag
  tag: "5.0.0"

# -- If defined, uses a Secret to pull an image from a private Docker registry or repository.
imagePullSecrets: []

# -- Number of replicas
replicaCount: 1

# -- The number of old ReplicaSets to retain
revisionHistoryLimit: 10

serviceAccount:
  # -- Specifies whether a service account should be created
  create: true
  # -- Annotations to add to the service account
  annotations: {}
  # -- The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

# -- Annotations to be added to pods
podAnnotations: {}

# -- Labels to be added to pods
podLabels: {}

# -- pod-level security context
podSecurityContext: {}
  # fsGroup: 2000

# -- container-level security context
securityContext: {}
  # capabilities:
  #   drop:
  #   - ALL
  # readOnlyRootFilesystem: true
  # runAsNonRoot: true
  # runAsUser: 1000

service:
  # -- Kubernetes service type
  type: ClusterIP
  # -- Kubernetes port where service is exposed
  port: 8080

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

# BETA: Configure the gateway routes for the chart here.
# More routes can be added by adding a dictionary key like the 'main' route.
# Being BETA this can/will change in the future without notice, do not use unless you want to take that risk
# [[ref]](https://gateway-api.sigs.k8s.io/references/spec/#gateway.networking.k8s.io%2fv1alpha2)
route:
  main:
    # -- Enables or disables the route
    enabled: false

    # -- Set the route apiVersion, e.g. gateway.networking.k8s.io/v1 or gateway.networking.k8s.io/v1alpha2
    apiVersion: gateway.networking.k8s.io/v1

    # -- Set the route kind
    # Valid options are GRPCRoute, HTTPRoute, TCPRoute, TLSRoute, UDPRoute
    kind: HTTPRoute

    # -- Add annotations to the route
    annotations: {}

    # -- Add labels to the route
    labels: {}

    # -- Hostnames to be matched
    hostnames: []
    # - my-filter.example.com

    # -- Parent references (Gateway)
    parentRefs: []
    # - name: acme-gw

    # -- define conditions used for matching the rule against incoming HTTP requests.
    # @default -- see [values.yaml](./values.yaml)
    matches:
      - path:
          type: PathPrefix
          value: /

    # -- Filters define the filters that are applied to requests that match this rule.
    filters: []

    # -- Additional custom rules that can be added to the route
    additionalRules: []

    # -- adds a filter for redirecting to https (HTTP 301 Moved Permanently). To redirect HTTP traffic to HTTPS, you need to have a Gateway with both HTTP and HTTPS listeners. Matches and filters do not take effect if enabled. Ref. https://gateway-api.sigs.k8s.io/guides/http-redirect-rewrite/
    httpsRedirect: false

# -- Resource limits and requests for the headwind pods.
resources: {}
  # We usually recommend not to specify default resources and to leave this as a conscious
  # choice for the user. This also increases chances charts run on environments with little
  # resources, such as Minikube. If you do want to specify resources, uncomment the following
  # lines, adjust them as necessary, and remove the curly braces after 'resources:'.
  # limits:
  #   cpu: 100m
  #   memory: 128Mi
  # requests:
  #   cpu: 100m
  #   memory: 128Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 100
  targetCPUUtilizationPercentage: 80
  # targetMemoryUtilizationPercentage: 80

# -- Node labels for pod assignment
nodeSelector: {}

# -- Toleration labels for pod assignment
tolerations: []

# -- Affinity settings for pod assignment
affinity: {}

# -- additional environment variables to be added to the pods. See https://shlink.io/documentation/environment-variables for a complete list.
extraEnv: []

config:
  database:
    auth:
      # -- The database name to be used when using an external database driver. Will be ignored when you activate one of the integrated databases with mariadb.enabled, mysql.enabled or postgresql.enabled
      database: ""
      # -- Use existing secret for password details (`config.database.auth.password` will be ignored and picked up from this secret). The secret has to contain the key `database-password`.
      existingSecret: ""
      # -- The password credential to be used when using an external database driver.
      password: ""
      # -- The username credential to be used when using an external database driver.
      username: ""
    # -- mysql, maria, postgres or sqlite. Will be set automatically when you activate one of the integrated databases with mariadb.enabled, mysql.enabled or postgresql.enabled
    driver: sqlite
    # -- The host name of the database server when using an external database driver. Will be ignored when you activate one of the integrated databases with mariadb.enabled, mysql.enabled or postgresql.enabled
    host: ""
    # -- The port in which the database service is running when using an external database driver. Default value is based on the value provided for DB_DRIVER. Will be ignored when you activate one of the integrated databases with mariadb.enabled, mysql.enabled or postgresql.enabled
    port: 0
    # -- Whether it is desired to use an encrypted connection with the database or not
    useEncryption: false
  general:
    # -- The base path from which you plan to serve Shlink, in case you don’t want to serve it from the root of the domain. It has to start with a bar, like /shlink. Defaults to ''.
    basePath: ""
    # -- A prefix used for all cache keys generated by Shlink. It’s important to set a unique value here if you have multiple Shlink instances sharing the same cache store (same server when not using redis, or same redis cluster), otherwise there could be collisions. Defaults to Shlink.
    cacheNamespace: ""
    # -- The default short domain used for this Shlink instance. For example s.test.
    defaultDomain: ""
    # -- An API key that will be created once during container start-up, with admin permissions.
    initialApiKey: ""
    # -- Tells if Shlink is served with https or not (true or false). It’s still up to you to actually serve it with HTTPS.
    isHttpsEnabled: false
    # -- The maximum amount of memory that every Shlink process can use. You can provide a number, which will be the amount of memory in bytes, or a number followed by K for kilobytes, M for megabytes or G for gigabytes. You can also provide -1 to set no memory limit. Defaults to 512M.
    memoryLimit: ""
    # -- A timezone code as defined [in this list](https://www.php.net/manual/en/timezones.php). All dates stored by Shlink (visits, short URL creation, etc) will be considered to be on this timezone. By default, the default timezone set in PHP config will be used, which is UTC in the case of the docker image.
    timezone: ""
  geolite:
    # -- The license key used to download new GeoLite2 database files. Go to GeoLite2 license key to know how to generate it. Not providing a license key will completely disable visits geolocation.
    licenseKey: ""
    # -- If provided with value true, it will skip the initial GeoLite2 db file download, speeding-up the container start-up. As a side effect, first visits on this container will remain un-located until the file finishes downloading in background.
    skipInitialDownload: false
  matomo:
    # -- Enable the Matomo integration to sent visits
    enabled: false
    auth:
      # -- The API token so that Shlink can call Matomo’s API
      apiToken: ""
      # -- Use existing secret for the API token details (`config.matomo.auth.apiToken` will be ignored and picked up from this secret). The secret has to contain the key `api-token`.
      existingSecret: ""
    # -- The external Matomo server URL.
    baseUrl: ""
    # -- The site ID to be used for Shlink visits.
    siteId: ""
  mercure:
    # -- Enable the Mercure Hub integration.
    enabled: false
    auth:
      # -- The secret key that was provided to the mercure hub server, in order to be able to generate valid JWTs for publishing/subscribing to that server.
      jwtSecret: ""
      # -- Use existing secret for the JWT secret details (`config.mercure.auth.jwtSecret` will be ignored and picked up from this secret). The secret has to contain the key `jwt-secret`.
      existingSecret: ""
    # -- The public URL of a mercure hub server to which Shlink will sent updates. This URL will also be served to consumers that want to subscribe to those updates.
    publicHubUrl: ""
    # -- An internal URL for a mercure hub. Will be used only when publishing updates to mercure, and does not need to be public.
    internalHubUrl: ""
  qrCodes:
    # -- Whether generating QR codes should work for disabled short URLs. Disabled short URLs are those which reached the maximum amount of visits, have a validSince date in the future, or a validUntil date in the past.
    codeForDisabledShortUrls: true
    defaultColors:
      # -- The QR code background color.
      background: "#FFFFFF"
      # -- The QR code foreground color.
      foreground: "#000000"
    # -- One of L (Low), M (Medium), Q (Quartile) or H (High), to determine the default error correction of generated QR codes when the errorCorrection query param is not provided.
    defaultErrorCorrection: l
    # -- One of png or svg, to determine the default format of generated QR codes when the format query param is not provided.
    defaultFormat: png
    # -- A URL pointing to a logo that will be placed in the middle of the QR code. This one is experimental, as some images might break the QR code.
    defaultLogoUrl: ""
    # -- A value greater than 0 to determine the default margin of generated QR codes when the margin query param is not provided.
    defaultMargin: 0
    # -- Tells if the block size should be round on QR codes, making it more readable, but potentially adding some extra margin as a side effect.
    defaultRoundBlockSize: true
    # -- A value between 50 and 1000 to determine the default size of generated QR codes when the size query param is not provided.
    defaultSize: 300
  rabbitmq:
    # -- enable RabbitMQ™ Integration
    enabled: false
    auth:
      # -- Use existing secret for password details (`config.rabbitmq.auth.password` will be ignored and picked up from this secret). The secret has to contain the key `rabbitmq-password`.
      existingSecret: ""
      # -- The password credential to be used when using an external database driver.
      password: ""
      # -- The username credential to be used when using an external database driver.
      username: ""
    # -- The RabbitMQ server host name
    host: ""
    # -- Whether connection is encrypted with SSL/TLS or not.
    useSsl: false
    # -- The RabbitMQ server VHost
    vhost: "/"
  redirects:
    # -- Allows to set the amount of seconds that redirects should be cached when redirect status is 301 or 308.
    cacheLifetime: 30
    # -- If a URL is provided here, when a user tries to access Shlink’s base URL, and the visited domain does not have a redirect URL of its own, he/she will be redirected to this value. If this env var is not provided, the user will see a generic 404 - not found page.
    defaultBaseUrlRedirect: ""
    # -- If a URL is provided here, when a user tries to access an invalid short URL, and the visited domain does not have a redirect URL of its own, he/she will be redirected to this value. If this env var is not provided, the user will see a generic 404 - not found page.
    defaultInvalidShortUrlRedirect: ""
    # -- If a URL is provided here, when a user tries to access a URL not matching any supported by the router, and the visited domain does not have a redirect URL of its own, he/she will be redirected to this value. If this env var is not provided, the user will see a generic 404 - not found page.
    defaultRegular404Redirect: ""
    # -- Determines how Shlink should match short URLs when they start with a known short code. Valid values are default, append and ignore. (See [Extra path forwarding](https://shlink.io/documentation/some-features/#extra-path-forwarding) for more info).
    extraPathMode: default
    # -- 301, 302, 308 or 307 (last two since v3.5.0). Determines the status code that should be used on redirects from short to long URLs. Setting 308 or 307 implicitly makes requests to short URLs work regardless the HTTP method.
    statusCode: 302
  redis:
    # -- enable Redis™ Integration
    enabled: false
    # -- Tells if the configured redis instance/cluster should also be used to publish real-time updates via redis pub/sub.
    pubSubEnabled: false
    sentinal:
      enabled: false
      # -- The name of the sentinel service if you want to use redis sentinel. If this value is provided, the servers provided in config.redis.servers will be considered sentinel instances.
      service: ""
    # -- The comma-separated list of Redis servers when using external Redis servers. Will be ignored when you activate one of the integrated Redis subchart with redis.enabled
    servers: ""
  robots:
    # -- Whether all short URLs should be allowed via robots.txt or not. If set to true, the crawlable option set in individual short URLs will be ignored.
    allowAllShortUrls: false
    # -- A comma-separated list of allowed user agents via robots.txt.
    userAgents: "*"
  trackingVisits:
    # -- Tells if IP addresses from visitors should be obfuscated before storing them in the database. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    anonymizeRemoteAddr: true
    # -- Tells if visits tracking should be completely disabled. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    disable: false
    # -- Tells if tracking of the IP address (and therefore visitors location) should be disabled. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    disableIpTracking: false
    # -- Tells if tracking of the referrer should be disabled. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    disableReferrerTracking: false
    # -- The name of a query param that can be used to visit short URLs avoiding the visit to be tracked. This feature won’t be available if no value is provided. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    disableTrackingParam: ""
    # -- A comma-separated list of IP address patterns from which all tracking should be disabled. It allows providing fixed IP addresses (100.200.80.40), CIDR blocks (192.168.10.0/24) or wildcard patterns (11.22.*.*)
    disableTrackingFrom: ""
    # -- Tells if tracking of the user agent should be disabled. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    disableUaTracking: false
    # -- Tells if orphan visits should be tracked or not. See [Tracking visits](https://shlink.io/documentation/tracking-visits/) for more info.
    trackOrphanVisits: true
  urlShortening:
    # -- Used to automatically resolve the short URL’s title based on the title-tag in the long URL
    autoResolveTitles: true
    # -- The length you want generated short codes to have. It defaults to 5 and has to be at least 4, so any value smaller than that will fall back to 4.
    defaultShortCodesLength: 5
    # -- The amount of visits on short URLs which will not allow them to be deleted. If not provided, this restriction will be disabled.
    deleteShortUrlThreshold: ""
    # -- Allows to create and handle multi-segment custom slugs when true is provided. See [multi-segment custom slugs](https://shlink.io/documentation/some-features/#multi-segment-custom-slugs) for more information.
    multiSegmentSlugsEnabled: false
    # -- Determines how to match short URLs. Valid values are strict or loose. See [short URLs mode](https://shlink.io/documentation/some-features/#short-urls-mode) for more information.
    shortUrlMode: strict
    # -- Allows to enable support for trailing slashes in short URLs when true is provided. See [short URLs trailing slash](https://shlink.io/documentation/some-features/#short-urls-trailing-slash) for more information.
    shortUrlTrailingSlash: false

mariadb:
  # -- enable integrated MariaDB™ subchart from Bitnami
  enabled: false
  auth:
    # -- The database name to be used when using the integrated MariaDB database.
    database: shlink
    # -- The password credential to be used when using the integrated MariaDB database.
    password: shlink
    # -- The username credential to be used when using the integrated MariaDB database.
    username: shlink
  image:
    # -- image repository for MariaDB™ subchart from Bitnami
    repository: bitnamilegacy/mariadb
    # -- image tag for MariaDB™ subchart from Bitnami
    tag: 12.0.2-debian-12-r0

mysql:
  # -- enable integrated MySQL™ subchart from Bitnami
  enabled: false
  auth:
    # -- The database name to be used when using the integrated MySQL database.
    database: shlink
    # -- The password credential to be used when using the integrated MySQL database.
    password: shlink
    # -- The username credential to be used when using the integrated MySQL database.
    username: shlink
  image:
    # -- image repository for MySQL™ subchart from Bitnami
    repository: bitnamilegacy/mysql
    # -- image tag for MySQL™ subchart from Bitnami
    tag: 9.4.0-debian-12-r1

postgresql:
  # -- enable integrated PostgreSQL™ subchart from Bitnami
  enabled: false
  auth:
    # -- The database name to be used when using the integrated PostgreSQL database.
    database: shlink
    # -- The password credential to be used when using the integrated PostgreSQL database.
    password: shlink
    # -- The username credential to be used when using the integrated PostgreSQL database.
    username: shlink
  image:
    # -- image repository for PostgreSQL™ subchart from Bitnami
    repository: bitnamilegacy/postgresql
    # -- image tag for PostgreSQL™ subchart from Bitnami
    tag: 17.6.0-debian-12-r4

rabbitmq:
  # -- enable integrated RabbitMQ™ subchart from Bitnami
  enabled: false
  image:
    # -- image repository for RabbitMQ™ subchart from Bitnami
    repository: bitnamilegacy/rabbitmq
    # -- image tag for RabbitMQ™ subchart from Bitnami
    tag: 4.1.3-debian-12-r1

redis:
  # -- enable integrated Redis™ subchart from Bitnami
  enabled: false
  # -- Redis™ architecture. Allowed values: `standalone` or `replication`
  architecture: standalone
  auth:
    # -- Enable password authentication
    enabled: false
    # -- Enable password authentication on Redis™ Sentinels
    sentinel: false
  sentinel:
    # -- Use Redis™ Sentinel on Redis™ pods
    enabled: false
  image:
    # -- image repository for Redis™ subchart from Bitnami
    repository: bitnamilegacy/redis
    # -- image tag for Redis™ subchart from Bitnami
    tag: 8.2.1-debian-12-r0
